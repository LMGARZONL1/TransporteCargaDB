CREATE TABLE camion (
    num_placa    CHAR(10) NOT NULL,
    id_conductor NUMBER(10) NOT NULL,
    marca        VARCHAR2(20) NULL,
    modelo       VARCHAR2(20) NOT NULL,
    capacidad    VARCHAR2(20) NOT NULL,
    PRIMARY KEY ( num_placa )
);
--SELECT * FROM CAMION;
--DROP TABLE CAMION;

CREATE TABLE conductor (
    id_conductor NUMBER(10) NOT NULL,
    id_categoria NUMBER(10) NOT NULL,
    dni          CHAR(10) NOT NULL,
    num_licencia CHAR(15) NOT NULL,
    nombre       VARCHAR2(20) NOT NULL,
    apellido     VARCHAR2(20) NOT NULL,
    direccion    VARCHAR2(30) NOT NULL,
    telefono     NUMBER(10) NOT NULL,
    correo       VARCHAR2(35) NOT NULL,
    PRIMARY KEY ( id_conductor )
);

CREATE TABLE categoria (
    id_categoria NUMBER(10) NOT NULL,
    descripcion  VARCHAR2(30) NOT NULL,
    PRIMARY KEY ( id_categoria )
);

CREATE TABLE carga (
    id_carga          NUMBER(10) NOT NULL,
    id_factura        NUMBER(10) NOT NULL,
    id_conductor      NUMBER(10) NOT NULL,
    cantidad          NUMBER(10) NOT NULL,
    descripcion       VARCHAR2(40) NOT NULL,
    dirección_destino VARCHAR2(40) NOT NULL,
    peso              NUMBER(10) NOT NULL,
    PRIMARY KEY ( id_carga )
);

CREATE TABLE factura (
    id_factura         NUMBER(10) NOT NULL,
    id_empleado        NUMBER(10) NOT NULL,
    id_cliente         NUMBER(10) NOT NULL,
    cantidad_productos NUMBER(10) NOT NULL,
    descripcion        VARCHAR2(40) NULL,
    descuento          NUMBER(10, 2) NULL,
    valor_total        NUMBER(10, 2) NOT NULL,
    PRIMARY KEY ( id_factura )
);

CREATE TABLE empleado (
    id_empleado NUMBER(10) NOT NULL,
    dni         CHAR(9) NOT NULL,
    nombre      VARCHAR2(20) NOT NULL,
    apellido    VARCHAR2(30) NOT NULL,
    direccion   VARCHAR2(40) NOT NULL,
    telefono    NUMBER(20) NOT NULL,
    correo      VARCHAR2(35) NOT NULL,
	salario 	NUMBER(10) NOT NULL,
	fecha_ingreso date NOT NULL,
	fecha_retiro date NULL,
	estado_empleado VARCHAR2 (15) NOT NULL,
    PRIMARY KEY ( id_empleado )
);

CREATE TABLE cliente (
    id_cliente NUMBER(10) NOT NULL,
    dni        CHAR(9) NOT NULL,
    nombre     VARCHAR2(20) NOT NULL,
    apellido   VARCHAR2(30) NOT NULL,
    direccion  VARCHAR2(40) NOT NULL,
    telefono   NUMBER(20) NOT NULL,
    correo     VARCHAR2(35) NOT NULL,
    PRIMARY KEY ( id_cliente )
);

CREATE TABLE cargaestado (
    id_carga  NUMBER(10) NOT NULL,
    id_estado NUMBER(30) NOT NULL,
    fecha     DATE NOT NULL
);

CREATE TABLE estado (
    id_estado NUMBER(10) NOT NULL,
    nombre    VARCHAR2(50) NOT NULL,
    PRIMARY KEY ( id_estado )
);

--LLAVES FORENEAS

ALTER TABLE carga
    ADD FOREIGN KEY ( id_factura )
        REFERENCES factura ( id_factura );

ALTER TABLE carga
    ADD FOREIGN KEY ( id_conductor )
        REFERENCES conductor ( id_conductor );

ALTER TABLE camion
    ADD FOREIGN KEY ( id_conductor )
        REFERENCES conductor ( id_conductor );

ALTER TABLE conductor
    ADD FOREIGN KEY ( id_categoria )
        REFERENCES categoria ( id_categoria );

ALTER TABLE factura
    ADD FOREIGN KEY ( id_empleado )
        REFERENCES empleado ( id_empleado );

ALTER TABLE factura
    ADD FOREIGN KEY ( id_cliente )
        REFERENCES cliente ( id_cliente );

ALTER TABLE cargaestado
    ADD FOREIGN KEY ( id_carga )
        REFERENCES carga ( id_carga );

ALTER TABLE cargaestado
    ADD FOREIGN KEY ( id_estado )
        REFERENCES estado ( id_estado );

DESCRIBE CARGA;

--UNICO DATOS

ALTER TABLE CONDUCTOR ADD CONSTRAINT UQ_CONDUCTOR_DNI UNIQUE (DNI);
ALTER TABLE EMPLEADO ADD CONSTRAINT UQ_EMPLEADO_DNI UNIQUE (DNI);
ALTER TABLE CLIENTE ADD CONSTRAINT UQ_CLIENTE_DNI UNIQUE (DNI);

-- INGRESAR DATOS DE CLIENTES 

INSERT INTO CATEGORIA VALUES (01,'B1');
INSERT INTO CATEGORIA VALUES (02,'B2');
INSERT INTO CATEGORIA VALUES (03,'B3');
INSERT INTO CATEGORIA VALUES (04,'C1');
INSERT INTO CATEGORIA VALUES (05,'C2');
INSERT INTO CATEGORIA VALUES (06,'C3');

INSERT INTO ESTADO VALUES (01,'PREPARACION');
INSERT INTO ESTADO VALUES (02,'DESPACHADO');
INSERT INTO ESTADO VALUES (03,'ENTREGADO');
INSERT INTO ESTADO VALUES (04,'ANULADO');
INSERT INTO ESTADO VALUES (05,'DEVUELTO');

INSERT INTO  CONDUCTOR VALUES (01,01,'76967392','6029120','JOAN','AYALA FERRERAS','DOCTOR FLEMING , 11',938202768,'JOAN_AYALA@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (08,04,'82064844','9851775','TONI','MAS FRANCH','PIRINEUS , 34',936524446,'TONI_MAS@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (02,02,'86101154','5885492','MARIA ISABEL','BARALDÉS COMAS','JAUME GALOBART , 12',938385567,'MARIA_BARS@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (03,03,'23101072','2191905','JORDI','RAYA GAVILAN','JACINT VERDAGUER',938754554,'JORDI_R@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (04,04,'32310703','6358613','LUIS','ZAMBUDIO FIGULS','CASA NOVA , ',936875544,'LUIS_ZAMBU@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (05,05,'19070178','3855416','DAVID','BIDAULT PUEYO','CASTELLS , 12, 2N',934500611,'DAVID69@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (06,06,'96434336','1804138','GEMMA','LISTAN FIGUERAS','AVINGUDA TRE,3,1R',939965585,'GEMMA_01@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (07,03,'80920973','8671148','ALBERT','ARNALOT PUIG','DIPUTACIÓ , 10',938204054,'ALBERT@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (09,05,'73142460','3981992','MARCELA','BAJONA GARCIA','BERTRAND  SERRA 11,3',938727589,'MARCELA@GMAIL.COM');
INSERT INTO  CONDUCTOR VALUES (10,01,'88322537','4198563','SERGI','TORRUELLA GARCIA','PADRÓ , 83',936021048,'SERGI_TOR@GMAIL.COM');

SELECT * FROM CONDUCTOR;

INSERT INTO  EMPLEADO VALUES (01,'19978696','MARTA','BARCONS LARA','ESPORTS , 12',8360281,'BARCONS@HOTMAIL.COM',1750000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (02,'74381433','JOAN','ALEU PRAT','CARRERA  1',8770878,'ALEU@HOTMAIL.COM',1870000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (03,'49607697','DAMIA','BARALDES TARRAGO','FRANCESC VITÒRIA  11',8727244,'BARCONS@HOTMAIL.COM',1500000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (04,'69223541','ANNA','RIVERO FLORIDO','VILATORRADA  6',7712563,'RIVERO@GMAIL.COM',1750000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (05,'53369281','JULIA','AREVALO SANCHEZ','JAUME I  10',8755603,'AREVALO@LIVE.COM',1870000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (06,'92332691','LUCIA','ALVAREZ DOMENECH','PROR PADRÓ , 2A.',8300045,'ALVAREZ@OUTLOOK.COM',1750000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (07,'46307112','ADRIANA','MONROS','CALLE 143, 54',8725885,'MONROS@GMAIL.COM',1500000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (08,'94181073','GERARD','LÓPEZ DE PABLO GARCIA UCEDA','BELLAVISTA  30',6520741,'GERARD@GMAIL.COM',1750000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (09,'70011569','LAURA','BIDAULT CULLERÉS','CAICEDO 92',5880712,'BIDAULT@HOTMAIL.COM',1750000,'18/10/22','','ACTIVO');
INSERT INTO  EMPLEADO VALUES (10,'94878846','DOUNYA','ZAFRA FIGULS','CASA SARA 132',6542775,'ZAFRA@GMAIL.COM',1870000,'18/10/22','','ACTIVO');

SELECT * FROM EMPLEADO;

INSERT INTO  CLIENTE VALUES (01,'75569758','JULIO','ALEU ICART','ARTÈS  1A.',8773545,'JULIO@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (02,'97544680','XAVIER','BENITEZ JOSE','SANT VALENTÍ  12',7885544,'XAVIER@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (03,'19858108','MARIA','MOLINER GARRIDO','DIAGONAL 39, 1R',6584541,'MARIA@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (04,'84586363','GEMMA','ALAVEDRA SUNYÉ','MANELIC , 1',8773941,'GEMMA@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (05,'63744227','MARIA ISABEL','ALIGUÉ BONVEHÍ','DE LA PESCA ,12F',8305295,'MARIA ISABEL@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (06,'12324627','INGRID','BIDAULT PÉREZ','SANT BENET  2N',4500644,'INGRID@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (07,'29087680','JORDI','BELMONTE SÁNCHEZ','JOAN XXIII ,2A',8350511,'JORDI@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (08,'55669077','DAVID','ALGUÉ TRANCHO','JACINT VERDAGUER 7',8770077,'DAVID@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (09,'95431689','ALEIX','ALBERICH RODRIGUEZ','SANT ISCLE , 1',8773933,'ALEIX@GMAIL.COM');
INSERT INTO  CLIENTE VALUES (10,'98866253','GEMMA','PORTELLA GISPETS','JACINT DAGUER , 49  2A',6565448,'GEMMA@GMAIL.COM');

SELECT * FROM CLIENTE;

INSERT INTO  CAMION VALUES('YTR098',01,'CHEVROLET','NKR II M2014','5500');
INSERT INTO  CAMION VALUES('NTE574',02,'HINO','DUTRO PRO 300','1550');
INSERT INTO  CAMION VALUES('FQA698',03,'CHEVROLET','NPR','7500');
INSERT INTO  CAMION VALUES('ELU489',04,'JMC','CHR','2360');
INSERT INTO  CAMION VALUES('WQN097',05,'Hyundai','EX8','5275');
INSERT INTO  CAMION VALUES('KLN175',06,'Hyundai','EX8','5275');
INSERT INTO  CAMION VALUES('SDQ741',07,'CHEVROLET','NKR II M2014','5500');
INSERT INTO  CAMION VALUES('TGC987',08,'JMC','CHR','2360');
INSERT INTO  CAMION VALUES('DJI670',09,'CHEVROLET','NPR','7500');
INSERT INTO  CAMION VALUES('AHX861',10,'HINO','DUTRO PRO 300','1550');

SELECT * FROM CAMION;

INSERT INTO  FACTURA VALUES (01,01,07,10,'CEMENTO',5,300000);
INSERT INTO  FACTURA VALUES (02,02,08,15,'CAJAS MEDICAMENTOS',2,8145000);
INSERT INTO  FACTURA VALUES (03,03,03,20,'CAJAS DE ASEO',8,2860000);
INSERT INTO  FACTURA VALUES (04,04,04,14,'CAJAS UTIL ESCOLAR',10,2492000);
INSERT INTO  FACTURA VALUES (05,05,01,10,'VARILLAS',5,360000);
INSERT INTO  FACTURA VALUES (06,06,02,9,'CAJAS DE TECNOLOGIA',6,40500000);
INSERT INTO  FACTURA VALUES (07,07,03,8,'ENSERES',3,34560000);
INSERT INTO  FACTURA VALUES (08,08,04,7,'CEMENTO',5,210000);
INSERT INTO  FACTURA VALUES (09,09,05,11,'ENSERES',3,47520000);
INSERT INTO  FACTURA VALUES (10,10,06,13,'CAJAS MEDICAMENTOS',2,7059000);
INSERT INTO  FACTURA VALUES (11,06,07,18,'ENSERES',3,77760000);
INSERT INTO  FACTURA VALUES (12,07,08,20,'VARILLAS',5,720000);
INSERT INTO  FACTURA VALUES (13,08,09,19,'CAJAS UTIL ESCOLAR',10,3382000);
INSERT INTO  FACTURA VALUES (14,02,10,17,'CAJAS DE TECNOLOGIA',6,76500000);
INSERT INTO  FACTURA VALUES (15,03,01,14,'CAJAS DE ASEO',8,2002000);
INSERT INTO  FACTURA VALUES (16,01,02,10,'CEMENTO',5,300000);
INSERT INTO  FACTURA VALUES (17,09,09,13,'CAJAS MEDICAMENTOS',2,7059000);
INSERT INTO  FACTURA VALUES (18,01,10,15,'CAJAS DE ASEO',8,2145000);
INSERT INTO  FACTURA VALUES (19,05,06,16,'CAJAS UTIL ESCOLAR',10,2848000);
INSERT INTO  FACTURA VALUES (20,05,07,5,'CEMENTO',5,150000);

SELECT * FROM FACTURA;

DELETE FROM FACTURA;

INSERT INTO  CARGA VALUES (01,01,01,10,'CEMENTO','JOAN XXIII ,2A',500);
INSERT INTO  CARGA VALUES (02,02,02,15,'CAJAS MEDICAMENTOS','JACINT VERDAGUER 7',375);
INSERT INTO  CARGA VALUES (03,03,03,20,'CAJAS DE ASEO','DIAGONAL 39, 1R',200);
INSERT INTO  CARGA VALUES (04,04,04,14,'CAJAS UTIL ESCOLAR','MANELIC , 1',210);
INSERT INTO  CARGA VALUES (05,05,05,10,'VARILLAS','ARTÈS  1A.',50);
INSERT INTO  CARGA VALUES (06,06,06,9,'CAJAS DE TECNOLOGIA','SANT VALENTÍ  12',225);
INSERT INTO  CARGA VALUES (07,07,07,8,'ENSERES','DIAGONAL 39, 1R',800);
INSERT INTO  CARGA VALUES (08,08,08,7,'CEMENTO','MANELIC , 1',350);
INSERT INTO  CARGA VALUES (09,09,09,11,'ENSERES','DE LA PESCA ,12F',1100);
INSERT INTO  CARGA VALUES (10,10,10,13,'CAJAS MEDICAMENTOS','SANT BENET  2N',325);
INSERT INTO  CARGA VALUES (11,11,04,18,'ENSERES','JOAN XXIII ,2A',1800);
INSERT INTO  CARGA VALUES (12,12,05,20,'VARILLAS','JACINT VERDAGUER 7',100);
INSERT INTO  CARGA VALUES (13,13,06,19,'CAJAS UTIL ESCOLAR','SANT ISCLE , 1',285);
INSERT INTO  CARGA VALUES (14,14,09,17,'CAJAS DE TECNOLOGIA','JACINT DAGUER , 49  2A',425);
INSERT INTO  CARGA VALUES (15,15,10,14,'CAJAS DE ASEO','ARTÈS  1A.',140);
INSERT INTO  CARGA VALUES (16,16,01,10,'CEMENTO','SANT VALENTÍ  12',500);
INSERT INTO  CARGA VALUES (17,17,02,13,'CAJAS MEDICAMENTOS','SANT ISCLE , 1',325);
INSERT INTO  CARGA VALUES (18,18,03,15,'CAJAS DE ASEO','JACINT DAGUER , 49  2A',150);
INSERT INTO  CARGA VALUES (19,19,04,16,'CAJAS UTIL ESCOLAR','SANT BENET  2N',240);
INSERT INTO  CARGA VALUES (20,20,05,5,'CEMENTO','JOAN XXIII ,2A',250);

SELECT * FROM CARGA;

INSERT INTO  CARGAESTADO VALUES(01,01,'31/10/2022');
INSERT INTO  CARGAESTADO VALUES(02,02,'10/11/22');
INSERT INTO  CARGAESTADO VALUES(03,03,'04/11/2022');
INSERT INTO  CARGAESTADO VALUES(04,05,'15/11/2022');
INSERT INTO  CARGAESTADO VALUES(05,01,'31/10/2022');
INSERT INTO  CARGAESTADO VALUES(06,01,'08/11/2022');
INSERT INTO  CARGAESTADO VALUES(07,03,'09/11/2022');
INSERT INTO  CARGAESTADO VALUES(08,04,'17/11/2022');
INSERT INTO  CARGAESTADO VALUES(09,03,'03/11/2022');
INSERT INTO  CARGAESTADO VALUES(10,03,'16/11/2022');
INSERT INTO  CARGAESTADO VALUES(11,03,'31/10/2022');
INSERT INTO  CARGAESTADO VALUES(12,03,'01/11/2022');
INSERT INTO  CARGAESTADO VALUES(13,05,'12/11/2022');
INSERT INTO  CARGAESTADO VALUES(14,02,'10/11/2022');
INSERT INTO  CARGAESTADO VALUES(15,01,'08/11/2022');
INSERT INTO  CARGAESTADO VALUES(16,02,'16/11/2022');
INSERT INTO  CARGAESTADO VALUES(17,03,'17/11/2022');
INSERT INTO  CARGAESTADO VALUES(18,03,'16/11/2022');
INSERT INTO  CARGAESTADO VALUES(19,04,'09/11/2022');
INSERT INTO  CARGAESTADO VALUES(20,03,'11/11/2022');

SELECT * FROM CARGAESTADO;

-- REPORTE QUE LE PERMITA OBTENER LA INFORMACIÓN TOTAL DE FACTURACIÓN POR CLIENTE

SELECT C.DNI,NOMBRE,APELLIDO,DIRECCION,
F.ID_FACTURA,CANTIDAD_PRODUCTOS,DESCRIPCION, DESCUENTO,VALOR_TOTAL 
FROM CLIENTE C 
JOIN FACTURA F 
ON C.ID_CLIENTE=F.ID_CLIENTE 
WHERE C.ID_CLIENTE=01;

SELECT C.DNI,NOMBRE,APELLIDO,DIRECCION,
F.ID_FACTURA,CANTIDAD_PRODUCTOS,DESCRIPCION, DESCUENTO,VALOR_TOTAL 
FROM CLIENTE C 
JOIN FACTURA F 
ON C.ID_CLIENTE=F.ID_CLIENTE 
WHERE C.DNI=75569758;

--REPORTE QUE LE PERMITA OBTENER LA INFORMACIÓN TOTAL DE LA ASIGNACION DE CONDUCTORES CON SUS RESPECTIVOS CAMIONES

SELECT CD.DNI,NOMBRE,APELLIDO,DIRECCION,TELEFONO,CORREO,
CM.NUM_PLACA,MARCA,MODELO 
FROM CONDUCTOR CD 
JOIN CAMION CM 
ON CD.ID_CONDUCTOR=CM.ID_CONDUCTOR;
--WHERE CD.ID_CONDUCTOR=01;


--REPORTE GENERAL DE NÓMINA DE ORDEN DE INGRESO DE FUNCIONARIOS VS SU SALARIO

SELECT E.DNI,NOMBRE,APELLIDO,SALARIO,F.VALOR_TOTAL FROM EMPLEADO E JOIN FACTURA F ON E.ID_EMPLEADO=F.ID_EMPLEADO WHERE E.ID_EMPLEADO=01;


SELECT E.DNI,NOMBRE,APELLIDO,SALARIO,F.VALOR_TOTAL,E.SALARIO-F.VALOR_TOTAL FROM EMPLEADO E JOIN FACTURA F ON E.ID_EMPLEADO=F.ID_EMPLEADO WHERE E.ID_EMPLEADO=01;


-- REPORTE QUE LE PERMITA ONTENER LA INFORMACIÓN TOTAL DE FACTURACIÓN POR CLIENTE

SELECT C.DNI,NOMBRE,APELLIDO,DIRECCION,
F.ID_FACTURA,CANTIDAD_PRODUCTOS,DESCRIPCION, DESCUENTO,VALOR_TOTAL 
FROM CLIENTE C 
JOIN FACTURA F 
ON C.ID_CLIENTE=F.ID_CLIENTE 
WHERE C.ID_CLIENTE=01;

SELECT C.DNI,NOMBRE,APELLIDO,DIRECCION,
F.ID_FACTURA,CANTIDAD_PRODUCTOS,DESCRIPCION, DESCUENTO,VALOR_TOTAL 
FROM CLIENTE C 
JOIN FACTURA F 
ON C.ID_CLIENTE=F.ID_CLIENTE 
WHERE C.DNI=75569758;

--REPORTE QUE LE PERMITA ONTENER LA INFORMACIÓN TOTAL DE LA ASIGNACION DE CONDUCTORES CON SUS RESPECTIVOS CAMIONES

SELECT CD.DNI,NOMBRE,APELLIDO,DIRECCION,TELEFONO,CORREO,
CM.NUM_PLACA,MARCA,MODELO 
FROM CONDUCTOR CD 
JOIN CAMION CM 
ON CD.ID_CONDUCTOR=CM.ID_CONDUCTOR;
--WHERE CD.ID_CONDUCTOR=01;


--REPORTE GENERAL DE NÓMINA DE ORDEN DE INGRESO DE FUNCIONARIOS VS SU SALARIO

SELECT E.DNI,NOMBRE,APELLIDO,SALARIO,F.VALOR_TOTAL FROM EMPLEADO E JOIN FACTURA F ON E.ID_EMPLEADO=F.ID_EMPLEADO WHERE E.ID_EMPLEADO=01;

SELECT E.DNI,NOMBRE,APELLIDO,SALARIO,E.SALARIO-F.VALOR_TOTAL, 
SUM(F.VALOR_TOTAL) AS "TOTAL VENTAS"
FROM EMPLEADO E 
JOIN FACTURA F 
ON E.ID_EMPLEADO=F.ID_EMPLEADO 
WHERE E.ID_EMPLEADO=01
GROUP BY E.DNI,NOMBRE,APELLIDO,SALARIO,E.SALARIO-F.VALOR_TOTAL;

SELECT E.DNI,NOMBRE,APELLIDO,SALARIO, 
SUM(F.VALOR_TOTAL) AS "TOTAL VENTAS" ,F.VALOR_TOTAL-E.SALARIO AS "DIFERENCIA"
FROM EMPLEADO E 
JOIN FACTURA F 
ON E.ID_EMPLEADO=F.ID_EMPLEADO 
WHERE E.ID_EMPLEADO=02
GROUP BY E.DNI,NOMBRE,APELLIDO,SALARIO,F.VALOR_TOTAL-E.SALARIO;

SELECT E.DNI,NOMBRE,APELLIDO,SALARIO, 
SUM(F.VALOR_TOTAL*cantidad_productos) AS "TOTAL VENTAS" ,
(F.VALOR_TOTAL*cantidad_productos)-E.SALARIO AS "DIFERENCIA"
FROM EMPLEADO E 
JOIN FACTURA F 
ON E.ID_EMPLEADO=F.ID_EMPLEADO 
--WHERE e.ID_EMPLEADO=02
GROUP BY E.DNI,NOMBRE,APELLIDO,SALARIO,(F.VALOR_TOTAL*cantidad_productos)-E.SALARIO;

-----UPDATE

UPDATE EMPLEADO SET valor_total=200000 WHERE id_factura=02;

--DELETE

DELETE FROM FACTURA WHERE ID_FACTURA=19;

DROP TABLE FACTURA;